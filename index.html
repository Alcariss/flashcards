<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flashcards</title>
  
  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#007BFF">
  <meta name="description" content="Interactive flashcards for learning fruits, vegetables, animals and more">
  <link rel="manifest" href="manifest.json">
  
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Flashcards">
  
  <!-- iOS Icons - Multiple Sizes -->
  <link rel="apple-touch-icon" sizes="57x57" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="60x60" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="72x72" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="76x76" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="114x114" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="120x120" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="144x144" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="icon-192.png">
  <link rel="apple-touch-icon" sizes="180x180" href="icon-192.png">
  
  <!-- iOS Splash Screens -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-startup-image" href="icon-512.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)">
  <link rel="apple-touch-startup-image" href="icon-512.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)">
  <link rel="apple-touch-startup-image" href="icon-512.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3)">
  <link rel="apple-touch-startup-image" href="icon-512.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">
  
  <!-- Fallback for older browsers -->
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  
  <style>
/* General styles for the page */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 20px;
  box-sizing: border-box;
  text-align: center;
  /* iOS-specific: Prevent bounce scrolling */
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  /* iOS-specific: Prevent text selection */
  -webkit-user-select: none;
  user-select: none;
}

/* iOS-specific: Fix viewport issues */
@supports (-webkit-touch-callout: none) {
  body {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
}

h1 {
  margin: 20px 0;
  font-size: 28px;
}

.controls {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
  margin: 20px;
}

button {
  padding: 10px 20px;
  font-size: 16px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  background-color: #007BFF;
  color: white;
  transition: background-color 0.3s;
}

button:hover {
  background-color: #0056b3;
}

#refreshButton {
  background-color: #2196F3;
}

#refreshButton:hover {
  background-color: #0b7dda;
}

/* Grid layout for flashcards */
.grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  gap: 15px;
  padding: 20px;
  margin: 0 auto;
  max-width: 600px;
  aspect-ratio: 1; /* Makes the grid container square */
}

/* Flashcard container */
.flashcard {
  width: 100%;
  aspect-ratio: 1; /* Makes each card square */
  perspective: 1000px;
}

.inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.5s;
  cursor: pointer;
}

.flashcard.flip .inner {
  transform: rotateY(180deg);
}

/* Front and back of the flashcard */
.front, .back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  border-radius: 8px;
}

.front {
  background-color: #f2f2f2;
  font-size: 4rem; /* Large emoji size - 64px */
}

.back {
  background-color: #4CAF50;
  color: white;
  transform: rotateY(180deg);
  font-size: 24px; /* Keep text size as original */
}

/* Responsive styles */
@media (max-width: 768px) {
  .controls {
    flex-direction: column;
    align-items: center;
  }

  button {
    width: 100%;
    max-width: 300px;
  }

  .grid {
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    padding: 10px;
    max-width: 400px;
  }

  .flashcard {
    aspect-ratio: 1; /* Keep cards square */
  }

  .front {
    font-size: 3rem; /* 48px for tablets */
  }

  .back {
    font-size: 20px; /* Keep text size as original */
  }
}

@media (max-width: 480px) {
  h1 {
    font-size: 24px;
  }

  button {
    font-size: 14px;
    padding: 8px 16px;
  }

  .grid {
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    gap: 10px;
    max-width: 300px;
  }

  .flashcard {
    aspect-ratio: 1; /* Keep cards square */
  }

  .front {
    font-size: 2.5rem; /* 40px for mobile */
  }

  .back {
    font-size: 16px; /* Keep text size as original */
  }
}
  </style>
</head>
<body>

  <div class="controls">
    <button data-category="fruits">Fruits</button>
    <button data-category="vegetables">Vegetables</button>
    <button data-category="vehicles">Vehicles</button>
    <button data-category="animals">Animals</button>
    <button data-category="sports">Sports</button>
    <button data-category="clothing">Clothing</button>
    <button data-category="halloween">ðŸŽƒ Halloween</button>
    <button id="refreshButton">Refresh Flashcards</button>
  </div>

  <div class="grid"></div>

  <script>
    // Categories data
    const categories = {
      fruits: [
        { name: "Apple", emoji: "ðŸŽ" },
        { name: "Banana", emoji: "ðŸŒ" },
        { name: "Cherry", emoji: "ðŸ’" },
        { name: "Grape", emoji: "ðŸ‡" },
        { name: "Lemon", emoji: "ðŸ‹" },
        { name: "Mango", emoji: "ðŸ¥­" },
        { name: "Orange", emoji: "ðŸŠ" },
        { name: "Peach", emoji: "ðŸ‘" },
        { name: "Pear", emoji: "ðŸ" },
        { name: "Pineapple", emoji: "ðŸ" },
        { name: "Strawberry", emoji: "ðŸ“" },
        { name: "Watermelon", emoji: "ðŸ‰" },
        { name: "Kiwi", emoji: "ðŸ¥" },
        { name: "Blueberry", emoji: "ðŸ«" },
        { name: "Coconut", emoji: "ðŸ¥¥" },
        { name: "Avocado", emoji: "ðŸ¥‘" },
        { name: "Tangerine", emoji: "ðŸŠ" }
      ],
      vegetables: [
        { name: "Carrot", emoji: "ðŸ¥•" },
        { name: "Broccoli", emoji: "ðŸ¥¦" },
        { name: "Potato", emoji: "ðŸ¥”" },
        { name: "Tomato", emoji: "ðŸ…" },
        { name: "Cucumber", emoji: "ðŸ¥’" },
        { name: "Onion", emoji: "ðŸ§…" },
        { name: "Garlic", emoji: "ðŸ§„" },
        { name: "Eggplant", emoji: "ðŸ†" },
        { name: "Pepper", emoji: "ðŸŒ¶ï¸" },
        { name: "Lettuce", emoji: "ðŸ¥¬" },
        { name: "Corn", emoji: "ðŸŒ½" },
        { name: "Mushroom", emoji: "ðŸ„" },
        { name: "Zucchini", emoji: "ðŸ¥’" },
        { name: "Spinach", emoji: "ðŸƒ" },
        { name: "Asparagus", emoji: "ðŸŒ¿" }
      ],
      vehicles: [
        { name: "Car", emoji: "ðŸš—" },
        { name: "Bus", emoji: "ðŸšŒ" },
        { name: "Bicycle", emoji: "ðŸš²" },
        { name: "Motorcycle", emoji: "ðŸï¸" },
        { name: "Truck", emoji: "ðŸšš" },
        { name: "Airplane", emoji: "âœˆï¸" },
        { name: "Boat", emoji: "â›´ï¸" },
        { name: "Helicopter", emoji: "ðŸš" },
        { name: "Train", emoji: "ðŸš†" },
        { name: "Tram", emoji: "ðŸš‹" },
        { name: "Scooter", emoji: "ðŸ›´" },
        { name: "Rocket", emoji: "ðŸš€" },
        { name: "Taxi", emoji: "ðŸš–" },
        { name: "Ship", emoji: "ðŸš¢" },
        { name: "Submarine", emoji: "ðŸ›³ï¸" }
      ],
      animals: [
        { name: "Dog", emoji: "ðŸ¶" },
        { name: "Cat", emoji: "ðŸ±" },
        { name: "Mouse", emoji: "ðŸ­" },
        { name: "Hamster", emoji: "ðŸ¹" },
        { name: "Rabbit", emoji: "ðŸ°" },
        { name: "Fox", emoji: "ðŸ¦Š" },
        { name: "Bear", emoji: "ðŸ»" },
        { name: "Panda", emoji: "ðŸ¼" },
        { name: "Koala", emoji: "ðŸ¨" },
        { name: "Tiger", emoji: "ðŸ¯" },
        { name: "Lion", emoji: "ðŸ¦" },
        { name: "Cow", emoji: "ðŸ®" },
        { name: "Pig", emoji: "ðŸ·" },
        { name: "Frog", emoji: "ðŸ¸" },
        { name: "Monkey", emoji: "ðŸµ" },
        { name: "Chicken", emoji: "ðŸ”" },
        { name: "Penguin", emoji: "ðŸ§" },
        { name: "Bird", emoji: "ðŸ¦" },
        { name: "Baby Chick", emoji: "ðŸ¤" },
        { name: "Hatching Chick", emoji: "ðŸ£" },
        { name: "Duck", emoji: "ðŸ¦†" },
        { name: "Eagle", emoji: "ðŸ¦…" },
        { name: "Owl", emoji: "ðŸ¦‰" },
        { name: "Bat", emoji: "ðŸ¦‡" },
        { name: "Wolf", emoji: "ðŸº" },
        { name: "Horse", emoji: "ðŸ´" },
        { name: "Unicorn", emoji: "ðŸ¦„" },
        { name: "Bee", emoji: "ðŸ" },
        { name: "Caterpillar", emoji: "ðŸ›" },
        { name: "Butterfly", emoji: "ðŸ¦‹" },
        { name: "Snail", emoji: "ðŸŒ" },
        { name: "Lady Beetle", emoji: "ðŸž" },
        { name: "Ant", emoji: "ðŸœ" },
        { name: "Spider", emoji: "ðŸ•·ï¸" },
        { name: "Scorpion", emoji: "ðŸ¦‚" },
        { name: "Crab", emoji: "ðŸ¦€" },
        { name: "Lobster", emoji: "ðŸ¦ž" },
        { name: "Shrimp", emoji: "ðŸ¦" },
        { name: "Squid", emoji: "ðŸ¦‘" },
        { name: "Octopus", emoji: "ðŸ™" },
        { name: "Fish", emoji: "ðŸŸ" },
        { name: "Tropical Fish", emoji: "ðŸ " },
        { name: "Blowfish", emoji: "ðŸ¡" },
        { name: "Shark", emoji: "ðŸ¦ˆ" },
        { name: "Whale", emoji: "ðŸ³" },
        { name: "Dolphin", emoji: "ðŸ¬" },
        { name: "Crocodile", emoji: "ðŸŠ" },
        { name: "Turtle", emoji: "ðŸ¢" },
        { name: "Lizard", emoji: "ðŸ¦Ž" },
        { name: "Snake", emoji: "ðŸ" },
        { name: "Dragon", emoji: "ðŸ‰" },
        { name: "Sauropod", emoji: "ðŸ¦•" },
        { name: "T-Rex", emoji: "ðŸ¦–" }
      ],
      sports: [
        { name: "playing football", emoji: "âš½ï¸" },
        { name: "playing basketball", emoji: "ðŸ€" },
        { name: "rollerblading", emoji: "ðŸ›¼" },
        { name: "swimming", emoji: "ðŸŠâ€â™€ï¸" },
        { name: "skateboarding", emoji: "ðŸ›¹" },
        { name: "flying a kite", emoji: "ðŸª" },
        { name: "riding a bike", emoji: "ðŸš²" },
        { name: "bouncing", emoji: "â›¹" },
        { name: "throwing a ball", emoji: "ðŸ¤½â€â™€ï¸" },
        { name: "playing baseball", emoji: "ðŸ¥Ž" }
      ],
      clothing: [
        { name: "T-Shirt", emoji: "ðŸ‘•" },
        { name: "dress", emoji: "ðŸ‘—" },
        { name: "trousers", emoji: "ðŸ‘–" },
        { name: "coat", emoji: "ðŸ§¥" },
        { name: "socks", emoji: "ðŸ§¦" },
        { name: "boots", emoji: "ðŸ‘¢" },
        { name: "shoes", emoji: "ðŸ‘Ÿ" },
        { name: "swimming costume", emoji: "ðŸ‘™" },
        { name: "gloves", emoji: "ðŸ§¤" },
        { name: "hat", emoji: "ðŸ§¢" },
        { name: "shorts", emoji: "ðŸ©³" },
        { name: "bag", emoji: "ðŸŽ’" },
        { name: "sunglasses", emoji: "ðŸ•¶ï¸" },
        { name: "umbrella", emoji: "â˜‚ï¸" }
      ],
      halloween: [
        { name: "Ghost", emoji: "ðŸ‘»" },
        { name: "Pumpkin", emoji: "ðŸŽƒ" },
        { name: "Witch", emoji: "ðŸ§™â€â™€ï¸" },
        { name: "Vampire", emoji: "ðŸ§›â€â™‚ï¸" },
        { name: "Zombie", emoji: "ðŸ§Ÿâ€â™‚ï¸" },
        { name: "Skeleton", emoji: "ðŸ’€" },
        { name: "Fairy", emoji: "ðŸ§šâ€â™€ï¸" },
        { name: "Spider", emoji: "ðŸ•·ï¸" },
        { name: "Bat", emoji: "ðŸ¦‡" },
        { name: "Black Cat", emoji: "ðŸ±â€ðŸ‘¤" },
        { name: "Witch Hat", emoji: "ðŸ§™â€â™€ï¸" },
        { name: "Crystal Ball", emoji: "ðŸ”®" },
        { name: "Cauldron", emoji: "ðŸ§ª" },
        { name: "Candy", emoji: "ðŸ¬" },
        { name: "Lollipop", emoji: "ðŸ­" },
        { name: "Chocolate", emoji: "ðŸ«" },
        { name: "Jack-o'-lantern", emoji: "ðŸŽƒ" },
        { name: "Haunted House", emoji: "ðŸšï¸" },
        { name: "Full Moon", emoji: "ðŸŒ•" },
        { name: "Coffin", emoji: "âš°ï¸" },
        { name: "Skull", emoji: "ðŸ’€" },
        { name: "Potion", emoji: "ðŸ§ª" },
        { name: "Magic Wand", emoji: "ðŸª„" },
        { name: "Tombstone", emoji: "ðŸª¦" },
        { name: "Candle", emoji: "ðŸ•¯ï¸" }
      ]
    };

    // State
    let selectedCategory = 'fruits';
    const grid = document.querySelector('.grid');

    // Utility functions
    const shuffleArray = (arr) => {
      const shuffled = [...arr];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    };

    const pronounce = (text) => {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      speechSynthesis.speak(utterance);
    };

    const createFlashcard = (item) => {
      const card = document.createElement('div');
      card.className = 'flashcard';
      card.innerHTML = `
        <div class="inner">
          <div class="front">${item.emoji}</div>
          <div class="back">${item.name}</div>
        </div>
      `;

      card.addEventListener('click', () => {
        const isFlipped = card.classList.contains('flip');
        
        if (!isFlipped) {
          // Card is showing emoji (front), pronounce and flip to text
          pronounce(item.name);
          card.classList.add('flip');
        } else {
          // Card is showing text (back), just flip back to emoji without pronouncing
          card.classList.remove('flip');
        }
      });

      return card;
    };

    const createFlashcards = () => {
      grid.innerHTML = '';
      const items = shuffleArray(categories[selectedCategory]).slice(0, 9);
      items.forEach(item => grid.appendChild(createFlashcard(item)));
    };

    // Event listeners
    document.addEventListener('click', (e) => {
      const categoryBtn = e.target.closest('[data-category]');
      if (categoryBtn) {
        selectedCategory = categoryBtn.dataset.category;
        createFlashcards();
        return;
      }

      if (e.target.id === 'refreshButton') {
        createFlashcards();
      }
    });

    // Initialize
    createFlashcards();

    // iOS Detection and PWA Features
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
    
    // iOS-specific install prompt (since beforeinstallprompt doesn't work on iOS)
    if (isIOS && !isStandalone) {
      const iosInstallBtn = document.createElement('div');
      iosInstallBtn.innerHTML = `
        <div style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); 
                    background: #007BFF; color: white; padding: 15px 20px; border-radius: 10px; 
                    font-size: 14px; z-index: 1000; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
          ðŸ“± Install this app: Tap <strong>Share</strong> â†’ <strong>Add to Home Screen</strong>
          <button onclick="this.parentElement.parentElement.remove()" 
                  style="background: none; border: none; color: white; font-size: 18px; float: right; cursor: pointer;">Ã—</button>
        </div>
      `;
      document.body.appendChild(iosInstallBtn);
      
      // Auto-hide after 10 seconds
      setTimeout(() => {
        if (iosInstallBtn.parentElement) {
          iosInstallBtn.remove();
        }
      }, 10000);
    }

    // PWA Install Prompt (for Android/Desktop)
    let deferredPrompt;
    
    window.addEventListener('beforeinstallprompt', (e) => {
      // Prevent Chrome 67 and earlier from automatically showing the prompt
      e.preventDefault();
      // Stash the event so it can be triggered later
      deferredPrompt = e;
      
      // Show install button
      const installBtn = document.createElement('button');
      installBtn.textContent = 'ðŸ“± Install App';
      installBtn.style.cssText = 'position: fixed; top: 10px; right: 10px; z-index: 1000; background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px;';
      installBtn.addEventListener('click', () => {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the install prompt');
          }
          deferredPrompt = null;
          installBtn.remove();
        });
      });
      document.body.appendChild(installBtn);
    });

    // Register Service Worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(registration => {
            console.log('SW registered successfully:', registration.scope);
            
            // Check for updates
            registration.addEventListener('updatefound', () => {
              console.log('New service worker available');
            });
          })
          .catch(registrationError => {
            console.error('SW registration failed:', registrationError);
          });
      });
    } else {
      console.log('Service workers are not supported');
    }

    // Network status indicator
    function updateNetworkStatus() {
      const status = navigator.onLine ? 'online' : 'offline';
      let indicator = document.getElementById('network-status');
      
      if (!indicator) {
        indicator = document.createElement('div');
        indicator.id = 'network-status';
        indicator.style.cssText = 'position: fixed; top: 10px; left: 10px; padding: 5px 10px; border-radius: 15px; font-size: 12px; z-index: 1000;';
        document.body.appendChild(indicator);
      }
      
      if (status === 'online') {
        indicator.style.background = '#28a745';
        indicator.style.color = 'white';
        indicator.textContent = 'ðŸŸ¢ Online';
      } else {
        indicator.style.background = '#dc3545';
        indicator.style.color = 'white';
        indicator.textContent = 'ðŸ”´ Offline';
      }
    }
    
    // Update network status
    window.addEventListener('online', updateNetworkStatus);
    window.addEventListener('offline', updateNetworkStatus);
    updateNetworkStatus(); // Initial check
  </script>
</body>
</html>
